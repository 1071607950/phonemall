<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <title>商品详情页</title>
    <link rel="stylesheet" type="text/css" href="/static/item/scss/shop.css"/>
    <link rel="stylesheet" type="text/css" href="/static/item/scss/jd.css"/>
    <link rel="stylesheet" href="/static/item/scss/header.css"/>
    <link rel="stylesheet" type="text/css" href="/static/item/bootstrap/css/bootstrap.css"/>
</head>
<body>
<div id="max">
    <header>
        <!--品牌官方网站-->
        <div class="min">
            <ul class="header_ul_left">
                <li class="glyphicon glyphicon-home" style="width: 100px"><a href="http://phonemall.com/" class="aa" style="margin-left: 10px;width: 100px">谷粒商城首页</a></li>
            </ul>
            <ul class="header_ul_right">
                <li style="border: 0;">
                    <a th:if="${session.loginUser == null}" href="http://auth.phonemall.com/login.html"
                       class="aa">你好，请登录</a>
                    <a th:if="${session.loginUser != null}">欢迎, [[${session.loginUser.nickname}]]</a>
                </li>
                <li>
                    <a th:if="${session.loginUser == null}" href="http://auth.phonemall.com/reg.html"
                       style="color: red;">免费注册</a>
                </li>
                <li>
                    <a th:if="${session.loginUser != null}" href="http://auth.phonemall.com/logout.html" class="li_2">立即退出</a>
                </li>
                <li><a href="http://member.phonemall.com/memberOrder.html" class="aa">我的订单</a> |</li>
            </ul>
        </div>
    </header>
    <nav>
        <div class="nav_min">
            <div class="nav_top">
                <div class="nav_top_one"><a href="http://phonemall.com"><img src="/static/item/image/logo1.jpg"/></a></div>
                <div class="nav_top_two"><input type="text"/>
                    <button>搜索</button>
                </div>
                <div class="nav_top_three"><a href="http://cart.phonemall.com/cart.html">我的购物车</a><span
                        class="glyphicon glyphicon-shopping-cart"></span>
                </div>
            </div>
        </div>
    </nav>
</div>

<div class="crumb-wrap">
    <div class="w">
        <div class="contact">
            <ul class="contact-ul">
                <li>
                    <a href="/static/item/#">
                        谷粒商城自营官方旗舰店
                    </a>
                    <span class="contact-sp">
								<span class="contact-sp1">
								GL
							</span>
							<span class="contact-sp2">
								自营
							    </span>
							</span>
                </li>
            </ul>
        </div>
    </div>
</div>
<div class="Shop">
    <div class="box">
        <div class="box-one ">
            <div class="boxx">
                <div class="imgbox">
                    <div class="probox">
                        <img class="img1" alt="" th:src="${item.info.skuDefaultImg}">
                        <div class="hoverbox"></div>
                    </div>
                    <div class="showbox">
                        <img class="img1" alt="" th:src="${item.info.skuDefaultImg}">
                    </div>
                </div>
                <div class="box-lh">
                    <div class="box-lh-one">
                        <ul>
                            <li th:each="img : ${item.images}" th:if="${!#strings.isEmpty(img.imgUrl)}"><img
                                    th:src="${img.imgUrl}"/></li>
                        </ul>
                    </div>
                    <div id="left">
                        <
                    </div>
                    <div id="right">
                        >
                    </div>
                </div>
            </div>
            <div class="box-two">
                <div class="box-name" th:text="${item.info.skuTitle}">
                    华为 HUAWEI Mate 10 6GB+128GB 亮黑色 移动联通电信4G手机 双卡双待
                </div>
                <div class="box-hide" th:text="${item.info.skuSubtitle}">预订用户预计11月30日左右陆续发货！麒麟970芯片！AI智能拍照！
                    <a href="/static/item/"><u></u></a>
                </div>
                <div class="box-summary clear">
                    <ul>
                        <li>价格</li>
                        <li>
                            <span>￥</span>
                            <span th:text="${#numbers.formatDecimal(item.info.price,3,2)}">4499.00</span>
                        </li>
                        <li style="color: red" th:if="${item.seckillSkuVo != null}">

                            <span th:if="${#dates.createNow().getTime() < item.seckillSkuVo.startTime}">
                                商品将会在[[${#dates.format(new java.util.Date(item.seckillSkuVo.startTime),"yyyy-MM-dd HH:mm:ss")}]]进行秒杀
                            </span>

                            <span th:if="${#dates.createNow().getTime() >= item.seckillSkuVo.startTime && #dates.createNow().getTime() <= item.seckillSkuVo.endTime}">
                                秒杀价  [[${#numbers.formatDecimal(item.seckillSkuVo.seckillPrice,1,2)}]]
                            </span>

                        </li>
                    </ul>
                </div>
                <div class="box-wrap clear">
                    <div class="box-wrap-one clear">
                        <ul>
                            <li>增值业务</li>
                            <li><img src="/static/item/img/90a6fa41d0d46b4fb0ff6907ca17c478.png"/></li>
                            <li><img src="/static/item/img/2e19336b961586468ef36dc9f7199d4f.png"/></li>
                            <li><img src="/static/item/img/1f80c3d6fabfd3418e54b005312c00b5.png"/></li>
                        </ul>
                    </div>
                </div>

                <div class="box-stock">
                    <ul class="box-ul">
                        <li>仓库</li>
                        <li class="box-stock-li">
                        </li>
                        <li>
                            <span th:text="${item.hasStock?'有货':'无货'}">无货， 此商品暂时售完</span>
                        </li>
                    </ul>
                </div>
                <div class="box-supply">
                    <ul class="box-ul">
                        <li></li>
                        <li>
                            由<span>谷粒商城</span> 发货，并提供售后服务
                        </li>
                    </ul>
                </div>
                <div class="box-attr-3">
                    <div class="box-attr clear" th:each="attr : ${item.saleAttr}">
                        <dl>
                            <dt>选择[[${attr.attrName}]]</dt>
                            <dd th:each="val : ${attr.attrValues}">
                                <a th:attr=" class=${#lists.contains(#strings.listSplit(val.skuIds,','),item.info.skuId.toString())
                                   ? 'sku_attr_value checked': 'sku_attr_value'}, skus=${val.skuIds} "
                                >
                                    [[${val.attrValue}]]
                                    <!--											<img src="/static/item/img/59ddfcb1Nc3edb8f1.jpg" /> -->
                                </a>
                            </dd>
                        </dl>
                    </div>
                </div>
                <div class="box-btns clear">
                    <div class="box-btns-one">
                        <input type="text" name="" id="productNum" value="1"/>
                        <div class="box-btns-one1">
                            <div>
                                <button id="jia">
                                    +
                                </button>
                            </div>
                            <div>
                                <button id="jian">
                                    -
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="box-btns-two"
                         th:if="${item.seckillSkuVo == null }">
                        <a class="addToCart" href="#" th:attr="skuId=${item.info.skuId}">
                            加入购物车
                        </a>
                    </div>

                    <div class="box-btns-two"
                         th:if="${item.seckillSkuVo != null && (#dates.createNow().getTime() >= item.seckillSkuVo.startTime && #dates.createNow().getTime() <= item.seckillSkuVo.endTime)}">
                        <a class="seckill" href="#"
                           th:attr="skuId=${item.info.skuId},sessionId=${item.seckillSkuVo.promotionSessionId},code=${item.seckillSkuVo.randomCode}">
                            立即抢购
                        </a>
                    </div>
                </div>
            </div>

        </div>
    </div>
    <!--欲约抢购流程-->
    <div class="ShopXiangqing">
        <!--商品介绍-->
        <div class="allquanbushop">
            <ul class="shopjieshao">
                <li class="jieshoa" style="background: #e4393c;">
                    <a style="color: white;">商品介绍</a>
                </li>
                <li class="baozhuang">
                    <a>规格与包装</a>
                </li>
            </ul>
            <ul class="shopjieshaos posi" style="display: none;">
                <li class="jieshoa" style="background: #e4393c;">
                    <a style="color: white;">商品介绍</a>
                </li>
                <li class="baozhuang">
                    <a>规格与包装</a>
                </li>
            </ul>

            <!--商品详情-->
            <div class="huawei">
                <ul class="xuanxiangka">
                    <li class="jieshoa actives" id="li1">
                        <div class="shanpinsssss">
                            <img class="xiaoguo" th:src="${descp}"
                                 th:each="descp : ${#strings.listSplit(item.desc.decript,',')}"/>
                        </div>
                    </li>
                    <li class="baozhuang actives" id="li2">
                        <div class="guiGebox">
                            <div class="guiGe" th:each="group : ${item.groupAttrs}">
                                <h3 th:text="${group.groupName}">主体</h3>
                                <dl>
                                    <div th:each="attr : ${group.attrs}">
                                        <dt th:text="${attr.attrName}">品牌</dt>
                                        <dd th:text="${attr.attrValue}">华为(HUAWEI)</dd>
                                    </div>
                                </dl>
                            </div>
                        </div>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</div>
</body>

<script src="/static/item/js/jquery1.9.js" type="text/javascript" charset="utf-8"></script>
<script src="/static/item/js/js.js" type="text/javascript" charset="utf-8"></script>
<script type="text/javascript">
</script>

<script>
    $(".sku_attr_value").click(function () {
        // 1、点击的元素添加上自定义的属性
        let skus = new Array();
        let curr = $(this).attr("skus").split(",");

        $(this).parent().parent().find(".sku_attr_value").removeClass("checked");
        $(this).addClass("checked");
        changeCheckedStyle();

        $("a[class='sku_attr_value checked']").each(function () {
            skus.push($(this).attr("skus").split(","));
        });

        let filterEle = skus[0];
        for (let i = 1; i < skus.length; i++) {
            filterEle = $(filterEle).filter(skus[i])[0];
        }

        location.href = "http://item.phonemall.com/" + filterEle + ".html";

        return false;
    });
    $(function () {
        changeCheckedStyle();
    });

    function changeCheckedStyle() {
        $(".sku_attr_value").parent().css({"border": "solid 1px #ccc"});
        $("a[class='sku_attr_value checked']").parent().css({"border": "solid 1px red"});
    };


    $(".addToCart").click(function () {
        let skuId = $(this).attr("skuId");
        let num = $("#productNum").val();
        location.href = "http://cart.phonemall.com/addCartItem?skuId=" + skuId + "&num=" + num;
        return false;
    });

    $(".seckill").click(function () {
        var isLogin = [[${session.loginUser != null}]];     //true
        if (isLogin) {
            var killId = $(this).attr("sessionid") + "-" + $(this).attr("skuid");
            var code = $(this).attr("code");
            var num = $("#productNum").val();
            location.href = "http://seckill.phonemall.com/kill?killId=" + killId + "&key=" + code + "&num=" + num;
        } else {
            alert("秒杀请先登录");
        }
        return false;
    });

</script>

</html>
